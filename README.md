# Auxo-Reporter

Largely derived from the existing Pie Reporter, this repository contains the scripts used to compute the rewards for veAUXO and xAUXO holders.

## Structure

```sh
merkleTree/     # Typescript MerkleTree generator with OpenZeppelin
reporter/       # Python application to parse config data into rewards database
reports/        # Output files relating to claims, voting, proposals, rewards and the final tree
```

## Installation

Make sure you have Python, Pip, NodeJS, Yarn installed. Python 3.10+ is recommended.

The [Makefile](./Makefile) contains a set of scripts to get you started. Provided you have `make` installed:

Setup the python venv and activate:

```sh
make venv
source venv/bin/activate
```

Install everything :

```sh
make setup
```

Check for type errors and format everything:

```sh
make lint
```

Run unit tests

```sh
make test
```

## Running the Application

Everything is built from a single config file:

```json
{
  "year": 2022, // must be YYYY
  "month": 11, // must be MM
  "block_snapshot": 16086234, // block to check stakers
  "distribution_window": 14, // increment previous window by 1
  "rewards": [
    // total rewards to distribute to all stakers
    {
      "token": "0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",
      "amount": "414134000000",
      "decimals": 6,
      "symbol": "USDC"
    },
    {
      "token": "0xD533a949740bb3306d119CC777fa900bA034cd52",
      "amount": "433907000000000000000000",
      "decimals": 18,
      "symbol": "CRV"
    },
    {
      "token": "0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2",
      "amount": "509976000000000000000000",
      "decimals": 18,
      "symbol": "WETH"
    }
  ]
}
```

Create the database of claims and rewards:

```sh
make claims
```

If all goes well, you should have a new folder `reports/{year}-{month}/`, i.e. `reports/2022-11/`.

In it you will have the following files

```sh
csv/                  # Report data in CSV format
json/                 # Report data in JSON format
claims.json           # Rewards by ethereum address, nil for inactive/slashed users
epoch-conf.json       # autogenerated config file based on your input config file
reporter-db.json      # Full breakdown of all generated data. Can be readable by TinyDB
```

You can then generate the merkle tree file with:

```sh
make tree
```

This will output a `merkle-tree.json` file in the reports folder for your passed epoch.

## Issues

Hop on over to the AUXO discord, [or contact me on github](https://github.com/jordaniza)
